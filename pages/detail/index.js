(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/index"],{"24af":function(e,n,t){"use strict";t.r(n);var r=t("fa75"),o=t("39cb");for(var i in o)"default"!==i&&function(e){t.d(n,e,(function(){return o[e]}))}(i);t("8acd");var u,c=t("f0c5"),a=Object(c["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],u);n["default"]=a.exports},"39cb":function(e,n,t){"use strict";t.r(n);var r=t("94a6"),o=t.n(r);for(var i in r)"default"!==i&&function(e){t.d(n,e,(function(){return r[e]}))}(i);n["default"]=o.a},"457f":function(e,n,t){},"8acd":function(e,n,t){"use strict";var r=t("457f"),o=t.n(r);o.a},"94a6":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(t("a34a")),o=t("7ddb"),i=t("b3df"),u=t("937d"),c=a(t("1427"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,n,t,r,o,i,u){try{var c=e[i](u),a=c.value}catch(s){return void t(s)}c.done?n(a):Promise.resolve(a).then(r,o)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function u(e){s(i,r,o,u,c,"next",e)}function c(e){s(i,r,o,u,c,"throw",e)}u(void 0)}))}}var l={data:function(){return{cover_id:"",cover:[],order:[],inspire:[],userInfo:[]}},onLoad:function(e){var n=this;n.getStore(),e.cover_id&&(n.cover_id=e.cover_id,n.getDetail())},onShow:function(){var e=this;e.getUser()},methods:{onDownload:function(){var n=this;e.downloadFile({url:0==n.cover.is_sync?n.cover.image.file_path:n.cover.cover_img,success:function(n){e.saveImageToPhotosAlbum({filePath:n.tempFilePath,success:function(){e.$u.toast("图片已下载")}})}})},onBuy:function(){var n=this;return d(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=n,!1!==o.userInfo){t.next=4;break}return e.navigateTo({url:"../passport/login"}),t.abrupt("return",!1);case 4:if(!o.order||20!=o.order.pay_status){t.next=7;break}return o.onCopyLink(),t.abrupt("return",!1);case 7:return t.next=9,(0,i.buy)({cover_id:o.cover.cover_id}).then((function(n){e.requestPayment({provider:"wxpay",timeStamp:n.payment.timeStamp,nonceStr:n.payment.nonceStr,package:"prepay_id="+n.payment.prepay_id,signType:"MD5",paySign:n.payment.paySign,success:function(e){o.getOrder()},fail:function(e){console.log("fail:"+JSON.stringify(e))}})})).catch((function(e){console.log(e)}));case 9:case"end":return t.stop()}}),t)})))()},onCopyLink:function(){var n=this;if(!1===n.userInfo)return e.navigateTo({url:"../passport/login"}),!1;n.order&&20==n.order.pay_status&&e.setClipboardData({data:n.order.code})},getUser:function(){var e=this;return d(r.default.mark((function n(){var t;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e,n.next=3,(0,u.detail)({}).then((function(e){e.userInfo&&(t.userInfo=e.userInfo,!1!==e.userInfo&&t.getOrder())})).catch((function(e){console.log(e)}));case 3:case"end":return n.stop()}}),n)})))()},doUnlock:function(){var n=this;if(!1===n.userInfo)return e.navigateTo({url:"../passport/login"}),!1;(0,i.unlock)({order_no:n.order.order_no}).then((function(e){console.log(e),n.getOrder()})).catch((function(e){console.log(e)}))},onClickUnlock:function(){var n=this;return n.userInfo.length<=0?(e.navigateTo({url:"../passport/login"}),!1):n.order&&20==n.order.pay_status?(n.onCopyLink(),!1):!1!==n.userInfo?1==n.cover.is_free?((0,i.unlock)({order_no:n.order.order_no}).then((function(e){n.getOrder(),setTimeout((function(){n.onCopyLink()}),1e3)})).catch((function(e){console.log(e)})),!0):n.inspire.rew_ad&&0==n.cover.is_free?(c.default.rewarded.show(),!0):(n.doUnlock(),!0):void e.navigateTo({url:"../passport/login"})},getDetail:function(){var e=this;return d(r.default.mark((function n(){var t;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e,n.next=3,(0,i.detail)({cover_id:t.cover_id}).then((function(e){t.cover=e.cover})).catch((function(e){console.log(e)}));case 3:case"end":return n.stop()}}),n)})))()},getStore:function(){var e=this;return d(r.default.mark((function n(){var t;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e,n.next=3,(0,o.store)({}).then((function(e){t.store=e.store,t.inspire=e.inspire,c.default.rewarded.load(t.inspire.rew_ad,(function(){(0,i.unlock)({order_no:t.order.order_no}).then((function(e){console.log(e),t.getOrder()})).catch((function(e){console.log(e)}))})),e.inspire.ins_ad&&(c.default.interstitial.load(e.inspire.ins_ad),setTimeout((function(){c.default.interstitial.show()}),1e3))})).catch((function(e){console.log(e)}));case 3:case"end":return n.stop()}}),n)})))()},getOrder:function(){var e=this;return d(r.default.mark((function n(){var t;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e,n.next=3,(0,i.order)({cover_id:t.cover_id}).then((function(e){t.order=e.order})).catch((function(e){console.log(e)}));case 3:case"end":return n.stop()}}),n)})))()},onShareTimeline:function(){var e=this;return{title:e.store.share.title,desc:e.store.share.desc,path:"/pages/cover/index?referee_id="+(e.userInfo?e.userInfo.user_id:"")}},onShareAppMessage:function(){var e=this,n=1==e.cover.is_sync?e.cover.cover_img:e.cover.image.file_path;return{title:e.store.share.title,desc:e.store.share.desc,path:"/pages/detail/index?cover_id="+e.cover.cover_id+"&referee_id="+e.userInfo.user_id,imageUrl:n}}}};n.default=l}).call(this,t("543d")["default"])},b04c:function(e,n,t){"use strict";(function(e){t("1d89");r(t("66fd"));var n=r(t("24af"));function r(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},fa75:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return r}));var r={uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"5111"))},uButton:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-button/u-button")]).then(t.bind(null,"b501"))},uGrid:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-grid/u-grid")]).then(t.bind(null,"4f73"))},uGridItem:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-grid-item/u-grid-item")]).then(t.bind(null,"c3ce"))},"u-Text":function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u--text/u--text")]).then(t.bind(null,"102f"))}},o=function(){var e=this,n=e.$createElement;e._self._c},i=[]}},[["b04c","common/runtime","common/vendor"]]]);